<!DOCTYPE HTML>
<html lang="zh-CN">
<head>
<title>优享GO - 包邮卡</title>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0;" name="viewport" />
<meta name="format-detection" content="telephone=no" />
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<link href="__CSS__/animate.css" type="text/css" rel="stylesheet" />
<style>
<style>
*
{ margin:0px; padding:0px;}
body
{font-size:14px; color:#444; font-family:"ff-tisa-web-pro-1","ff-tisa-web-pro-2","Lucida Grande","Hiragino Sans GB","Hiragino Sans GB W3";
min-width:320px; max-width:680px; min-height:100%; margin:0px auto; position:relative; background:#fcebd1; padding:0px; line-height:0px;}
.con
{ width:100%; height:auto; overflow:hidden; margin:0px; padding:0px;}
img
{ max-width:100%;}
.bg
{ width:100%; height:100%; background:#333; position:fixed; left:0px; top:0px; z-index:1; display:none;}
.reg
{ width:90%; height:90%; position:fixed; left:5%; top:5%; background:#fff; z-index:10; border-radius:8px; display:none;}
.reg .fromuser
{ text-align:center; margin-top:20px; font-size:16px;}
.reg .fromuser img
{ width:60px; height:60px; border-radius:50%; overflow:hidden; vertical-align:middle; margin-bottom:5px;}
.reg .form
{ margin:0px; padding:0px; margin-top:20px;}
.reg .form ul
{ list-style:none; margin:0px; padding:0px 20px;}
.reg .form ul li
{ width:100%; height:50px; line-height:50px; border-bottom:1px solid #CCCCCC; position:relative;}
.reg .form ul li .left
{ width:25%; float:left; text-align:center;}
.reg .form ul li .right
{ width:70%; float:left; position:relative;}
.reg .form ul li .right input
{ width:100%; height:30px; line-height:30px; border:none; background:#fff; color:#666;}
.reg .form ul li .right input:focus
{ color:#333;}
.reg .form ul li .right input.verify
{ width:120px;}
.reg .form ul li .ver
{ width:75px; height:25px; line-height:25px; text-align:center; color:#fff; position:absolute; right:25px; top:10px;}
.reg .form ul li .ver.focus
{ width:100px; right:5px;}
.reg .form ul li .ver.focus a
{ background:#ccc;}
.reg .form ul li .ver a
{ background:#ff4c90; border:none; color:#fff; font-size:12px; padding:2px 5px; border-radius:5px; display:block; width:100%; height:100%; text-decoration:none;}
.reg .form .submit
{ width:80%; height:35px; line-height:35px; text-align:center; background:#ff4c90; border:none; color:#fff; border-radius:5px;}
</style>
<script src="__JS__/jquery.js" type="text/javascript"></script>
<script src="__JS__/jquery.pjax.js" type="text/javascript"></script>
<script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
<script type="text/javascript">
wx.config({
    debug: false,
    appId: '{$signPackage.appId}',
    timestamp: {$signPackage.timestamp},
    nonceStr: '{$signPackage.nonceStr}',
    signature: '{$signPackage.signature}',
	jsApiList: [
        'checkJsApi',
        'onMenuShareTimeline',
        'onMenuShareAppMessage',
	]
});
wx.ready(function () {
	wx.onMenuShareAppMessage({
		title: '包邮卡', // 分享标题
		desc: '{:C(WEB_SITE_DESCRIPTION)}', // 分享描述
		link: 'http://{:C(WEB_SITE_DOMAIN)}/index/byk.html?openid={$openid}', // 分享链接
		imgUrl: 'http://{:C(WEB_SITE_DOMAIN)}/Public/wechat/images/baoyouka/1.png', // 分享图标
		type: '', // 分享类型,music、video或link，不填默认为link
		dataUrl: '', // 如果type是music或video，则要提供数据链接，默认为空
		success: function () { 
			
		},
		cancel: function () { 
			// 用户取消分享后执行的回调函数
		}
	});
	wx.onMenuShareTimeline({
		title: '包邮卡', // 分享标题
		link: 'http://{:C(WEB_SITE_DOMAIN)}/index/byk.html?openid={$openid}', // 分享链接
		imgUrl: 'http://{:C(WEB_SITE_DOMAIN)}/Public/wechat/images/baoyouka/1.png', // 分享图标
		success: function () { 
			
		},
		cancel: function () { 
		}
	});
});
</script>
</head>

<body>

<div class="con">

	<div class="line1"><img src="__IMG__/baoyouka/1.png"></div>
    <div class="line2"><a href="javascript:;" class="lingqu"><img src="__IMG__/baoyouka/2.png"></a></div>
    <div class="line3"><img src="__IMG__/baoyouka/3.png"></div>
</div>
<div class="bg"></div>
<div class="reg">
	
    <div class="fromuser">
    	<p><img src="{$frominfo.headimgurl}"><p>
        <p>{$frominfo.username} 邀请您加入！</p>
    </div>
    
    <div class="form">
        <form action="{:U('user/regapi')}" method="post" class="regform">
            <ul>
                <li>
                    <div class="left">手机号：</div>
                    <div class="right"><input type="tel" name="mobile" class="mobile" value="请输入手机号码"></div>
                </li>
                <li>
                    <div class="left">验证码：</div>
                    <div class="right"><input type="tel" name="verify" class="verify" value="请输入收到的验证码"></div>
                    <div class="ver"><a href="javascript:;" class="send_sms">发送验证码</a></div>
                </li>
            </ul>
            <div style="text-align:center; margin-top:20px;">
                <label><input type="checkbox" class="xieyi" checked="checked" value="1" />&nbsp;<a href="{:U('Article/detail?id=992')}">《优享GO用户服务协议》</a></label>
            </div>
            <div style=" text-align:center; margin-top:20px;">
            <input type="submit" value="立即注册并获取" class="submit">
            </div>
        </form>
    </div>
    
</div>

<script>
$(function(){
	$(".lingqu").click(function(){
		
		if("{$uid}">0){
			var url = "{:U('Index/lqbyj?pid=3')}";
			$.get(url,function(data){
				if(data=="1"){
					alert("领取成功！");
					window.location.href = "{:U('User/index')}";
				}else{
					alert(data);
					//window.location.href = location.href;
				}
				
			});
		}else{
			
			$(".bg").show();
			$(".reg").show();
			
		}
		
	});
	
	
	$(".send_sms").click(function(){
		var mobile = $(".mobile").val();
		if(mobile.length!=11){
			alert("请输入11位手机号码");
		}else{
			var url = "{:U('User/reg_send_sms')}?mobile="+mobile;
			$.get(url,function(data){
				if(data==true){
					$(".ver").addClass("focus");
					$(".send_sms").html("60秒后重新获取");
					var timer = 60;
					var djs = setInterval(function(){
						if(timer>0){
							timer = timer - 1;
							var str = timer+"秒后重新获取";
							$(".send_sms").html(str);
						}else{
							clearInterval(djs);
							$(".ver").removeClass("focus");
							$(".send_sms").html("发送验证码");
						}
					},1000)
				}
			});
		}
		return false;
	});
	
	$(".regform").submit(function(){
	
		var status = $(".xieyi").val();
		if(status==0){
			alert("您还未同意用户服务协议");
			return false;
		}
		
		var mobile = $(".mobile").val();
		if(mobile.length!=11){
			alert("请输入11位手机号码");
			return false;
		}
		var verify = $(".verify").val();
		if(verify.length!=4){
			alert("请输入4位验证码");
			return false;
		}
		
		var url = $(this).attr("action");
		var data = $(this).serialize();
		$.post(url,data).success(function(info){
			if(info=="1"){
				var url1 = "{:U('Index/lqbyj?pid=3')}";
				$.get(url1,function(data1){
					if(data1=="1"){
						alert("领取成功！");
						window.location.href = "{:U('User/index')}";
					}else{
						alert(data1);
						//window.location.href = location.href;
					}
				});
			}else{
				alert(info);
			}
		});
		
		return false;
		
	});
	
	$(".form ul input").focus(function(){
		$(this).val("");
		$(this).addClass("focus");
	});
	
});
</script>

</body>
</html>
