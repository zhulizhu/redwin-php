<!DOCTYPE HTML>
<html lang="zh-CN">
<head>
<title>【优享GO】恭喜发财，大吉大利！</title>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0;" name="viewport" />
<meta name="format-detection" content="telephone=no" />
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<link href="__CSS__/animate.css" type="text/css" rel="stylesheet" />
<style>
<style>
*
{ margin:0px; padding:0px;}
body
{font-size:14px; color:#444; font-family:"ff-tisa-web-pro-1","ff-tisa-web-pro-2","Lucida Grande","Hiragino Sans GB","Hiragino Sans GB W3";
min-width:320px; max-width:680px; min-height:100%; margin:0px auto; position:relative; background:#fcebd1; padding:0px; line-height:0px;}
.con
{ width:100%; height:auto; overflow:hidden; margin:0px; padding:0px;}
.con .line1
{ position:relative;}
.con .line1 .lingqu
{ width:100%; display:block; height:30%; position:absolute; left:0px; top:20%; background:none;}
.line3
{ position:relative;}
.line3 .text
{ width:90%; position:absolute; left:5%; top:140px; color:#fff; line-height:160%;}
.line3 .text p
{ margin:0px; padding:0px;}
img
{ max-width:100%;}
.bg
{ width:100%; height:100%; background:#333; position:fixed; left:0px; top:0px; z-index:1; display:none;}
.reg
{ width:90%; height:90%; position:fixed; left:5%; top:5%; background:#fff; z-index:10; border-radius:8px; display:none;}
.reg .fromuser
{ text-align:center; margin-top:20px; font-size:16px;}
.reg .fromuser img
{ width:60px; height:60px; border-radius:50%; overflow:hidden; vertical-align:middle; margin-bottom:5px;}
.reg .form
{ margin:0px; padding:0px; margin-top:20px;}
.reg .form ul
{ list-style:none; margin:0px; padding:0px 20px;}
.reg .form ul li
{ width:100%; height:50px; line-height:50px; border-bottom:1px solid #CCCCCC; position:relative;}
.reg .form ul li .left
{ width:25%; float:left; text-align:center;}
.reg .form ul li .right
{ width:70%; float:left; position:relative;}
.reg .form ul li .right input
{ width:100%; height:30px; line-height:30px; border:none; background:#fff; color:#666;}
.reg .form ul li .right input:focus
{ color:#333;}
.reg .form ul li .right input.verify
{ width:120px;}
.reg .form ul li .ver
{ width:75px; height:25px; line-height:25px; text-align:center; color:#fff; position:absolute; right:25px; top:10px;}
.reg .form ul li .ver.focus
{ width:100px; right:5px;}
.reg .form ul li .ver.focus a
{ background:#ccc;}
.reg .form ul li .ver a
{ background:#ff4c90; border:none; color:#fff; font-size:12px; padding:2px 5px; border-radius:5px; display:block; width:100%; height:100%; text-decoration:none;}
.reg .form .submit
{ width:80%; height:35px; line-height:35px; text-align:center; background:#ff4c90; border:none; color:#fff; border-radius:5px;}
.hongbao
{ width:70%; height:auto; position:fixed; left:15%; top:50px; z-index:20; color:#fff; display:none;}
.hongbao .content
{ width:100%; height:100%; position:absolute; left:0px; top:0px;}
.hongbao .content .face
{ width:25%; border-radius:50%; overflow:hidden; position:absolute; left:38%; top:30%;}
.hongbao .content .nickname
{ width:100%; height:auto; text-align:center; position:absolute; left:0px; top:50%; font-size:18px; color:#fff;}
.hongbao .content .money
{ width:100%; height:auto; text-align:center; position:absolute; left:0px; top:75%; font-size:36px; color:#fee646;}
.hongbao .content .xian
{ width:100%; height:auto; text-align:center; position:absolute; left:0px; top:80%; font-size:16px; color:#ecbebf;}
.hongbao .close
{ width:100%; height:30px; position:absolute; left:0px; bottom:0px; color:#fff; border-radius:8px; display:block; text-decoration:none; line-height:30px; text-align:center;}

.info
{ width:90%; position:absolute; left:5%; top:60%;}
.info .view
{ width:100%; height:30px; line-height:30px; text-align:center; color:#fff; text-decoration:underline; display:block;}
.info .wenzi
{ line-height:180%; color:#fff; display:none;}

</style>
<script src="__JS__/jquery.js" type="text/javascript"></script>
<script src="__JS__/jquery.pjax.js" type="text/javascript"></script>
<script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
<script type="text/javascript">
wx.config({
    debug: false,
    appId: '{$signPackage.appId}',
    timestamp: {$signPackage.timestamp},
    nonceStr: '{$signPackage.nonceStr}',
    signature: '{$signPackage.signature}',
	jsApiList: [
        'checkJsApi',
        'onMenuShareTimeline',
        'onMenuShareAppMessage',
	]
});
wx.ready(function () {
	wx.onMenuShareAppMessage({
		title: '【优享GO】恭喜发财，大吉大利！', // 分享标题
		desc: '{:C(WEB_SITE_DESCRIPTION)}', // 分享描述
		link: 'http://{:C(WEB_SITE_DOMAIN)}/index/userhb/id/{$info.id}.html?openid={$openid}', // 分享链接
		imgUrl: 'http://{:C(WEB_SITE_DOMAIN)}/Public/wechat/images/hb/user.png', // 分享图标
		type: '', // 分享类型,music、video或link，不填默认为link
		dataUrl: '', // 如果type是music或video，则要提供数据链接，默认为空
		success: function () { 
			
		},
		cancel: function () { 
			// 用户取消分享后执行的回调函数
		}
	});
	wx.onMenuShareTimeline({
		title: '【优享GO】恭喜发财，大吉大利！', // 分享标题
		link: 'http://{:C(WEB_SITE_DOMAIN)}/index/userhb/id/{$info.id}.html?openid={$openid}', // 分享链接
		imgUrl: 'http://{:C(WEB_SITE_DOMAIN)}/Public/wechat/images/hb/user.png', // 分享图标
		success: function () { 
			
		},
		cancel: function () { 
		}
	});
});
</script>
</head>

<body>

<div class="con">

	<div class="line1"><img src="__IMG__/hb/user.png?time={NOW_TIME}">
    <a href="javascript:;" class="lingqu"></a>
    <div class="info">
    	<a href="javascript:;" class="view" style="text-decoration:underline;">查看红包细则</a>
        <div class="wenzi">
        	1：领取的红包仅限在优享GO商城以优惠券的形式使用，且每笔订单只能使用一张<br>
            2：会员领取的红包请在“个人中心”中的优惠券中查看<br>
3：会员制作的红包请在个人中心中“发出去的红包”中查看<br>
4：在法律允许的范围内，优享GO商城可能对优惠劵规则作出适当的调整/修改
        </div>
    </div>
    </div>
</div>
<div class="bg"></div>
<div class="reg">
	
    <div class="fromuser">
    	<p><img src="{$frominfo.headimgurl}"><p>
        <p>{$frominfo.username} 邀请您加入！</p>
    </div>
    
    <div class="form">
        <form action="{:U('user/regapi')}" method="post" class="regform">
            <ul>
                <li>
                    <div class="left">手机号：</div>
                    <div class="right"><input type="tel" name="mobile" class="mobile" value="请输入手机号码"></div>
                </li>
                <li>
                    <div class="left">验证码：</div>
                    <div class="right"><input type="tel" name="verify" class="verify" value="请输入收到的验证码"></div>
                    <div class="ver"><a href="javascript:;" class="send_sms">发送验证码</a></div>
                </li>
            </ul>
            <div style="text-align:center; margin-top:20px;">
                <label><input type="checkbox" class="xieyi" checked="checked" value="1" />&nbsp;<a href="{:U('Article/detail?id=992')}">《优享GO用户服务协议》</a></label>
            </div>
            <div style=" text-align:center; margin-top:20px;">
            <input type="submit" value="立即注册并获取" class="submit">
            </div>
        </form>
    </div>
    
</div>

<div class="hongbao animated">
	<img src="__IMG__/hongbao.png" />
    <div class="content">
    	<div class="face"><img src="{$userinfo.headimgurl}" /></div>
    	<div class="nickname">{$userinfo.nickname}</div>
        <div class="money"></div>
    </div>
   	<a href="{:U('User/index')}" class="close">收下了,去商城查看>></a>
</div>

<script>
$(function(){
	
	$(".view").click(function(){
		$(".wenzi").show();
	});
	
	$(".lingqu").click(function(){
		
		if("{$uid}">0){
			var url = "{:U('Index/lquserhb?pid='.$info[id])}";
			$.get(url,function(data){
				if(data=="0"){
					alert("未注册！");
				}else if(data=="-1"){
					alert("红包不存在！");
				}else if(data=="-2"){
					alert("已经领过该红包了！");
				}else if(data=="-3"){
					alert("红包已经被领完了！");
				}else{
					$(".bg").show();
					$(".reg").hide();
					$(".hongbao").show().addClass("lightSpeedIn");
					$(".face").height($(".face").width());
					$(".money").html(data+"元");
				}
			});
		}else{
			
			$(".bg").show();
			$(".reg").show();
			
		}
		
	});
	
	
	$(".send_sms").click(function(){
		var mobile = $(".mobile").val();
		if(mobile.length!=11){
			alert("请输入11位手机号码");
		}else{
			var url = "{:U('User/reg_send_sms')}?mobile="+mobile;
			$.get(url,function(data){
				if(data==true){
					$(".ver").addClass("focus");
					$(".send_sms").html("60秒后重新获取");
					var timer = 60;
					var djs = setInterval(function(){
						if(timer>0){
							timer = timer - 1;
							var str = timer+"秒后重新获取";
							$(".send_sms").html(str);
						}else{
							clearInterval(djs);
							$(".ver").removeClass("focus");
							$(".send_sms").html("发送验证码");
						}
					},1000)
				}
			});
		}
		return false;
	});
	
	$(".regform").submit(function(){
	
		var status = $(".xieyi").val();
		if(status==0){
			alert("您还未同意用户服务协议");
			return false;
		}
		
		var mobile = $(".mobile").val();
		if(mobile.length!=11){
			alert("请输入11位手机号码");
			return false;
		}
		var verify = $(".verify").val();
		if(verify.length!=4){
			alert("请输入4位验证码");
			return false;
		}
		
		var url = $(this).attr("action");
		var data = $(this).serialize();
		$.post(url,data).success(function(info){
			if(info=="1"){
				var url1 = "{:U('Index/lquserhb?pid='.$info[id])}";
				$.get(url1,function(data1){
					if(data=="0"){
						alert("未注册！");
					}else if(data=="-1"){
						alert("红包不存在！");
					}else if(data=="-2"){
						alert("已经领过该红包了！");
					}else if(data=="-3"){
						alert("红包已经被领完了！");
					}else{
						$(".bg").show();
						$(".reg").hide();
						$(".hongbao").show().addClass("lightSpeedIn");
						$(".face").height($(".face").width());
						$(".money").html(data+"元");
					}
				});
			}else{
				alert(info);
			}
		});
		
		return false;
		
	});
	
	$(".form ul input").focus(function(){
		$(this).val("");
		$(this).addClass("focus");
	});
	
});
</script>

</body>
</html>
